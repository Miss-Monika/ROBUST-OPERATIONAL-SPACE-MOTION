
clear all; clc;

syms  th1 th2 th3 th4 th5 th1dot th2dot th3dot th4dot th5dot ; 
syms m1 m2 m3 m4 m5 g;
syms waist_width crus thigh spine shoulder bicep_arm forearm; % length of parts


th1ddot=0;
th2ddot =0;
th3ddot=0;
th4ddot=0;
th5ddot=0;
% g=0;



tau1 = m3*(crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1ddot*cos(th1) - crus*th1dot^2*sin(th1) + thigh*cos(th1 - th2)*(th1ddot - th2ddot) - thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - g*m2*(crus*sin(th1) + (thigh*sin(th1 - th2))/2) + m2*(crus*sin(th1) + (thigh*sin(th1 - th2))/2)*(crus*th1ddot*sin(th1) + crus*th1dot^2*cos(th1) + (thigh*sin(th1 - th2)*(th1ddot - th2ddot))/2 + (thigh*cos(th1 - th2)*(th1dot - th2dot)^2)/2) - m5*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + crus*cos(th1) + thigh*cos(th1 - th2))*(bicep_arm*cos(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) - crus*th1ddot*cos(th1) - spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*sin(th1) - thigh*cos(th1 - th2)*(th1ddot - th2ddot) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1ddot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot))/2 - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + m5*(spine*sin(th1 - th2 + th3) - bicep_arm*sin(th1 - th2 + th3 - th4) + crus*sin(th1) + thigh*sin(th1 - th2) - (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1ddot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2ddot - th1ddot - th3ddot + th4ddot + th5ddot))/2 - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - g*m3*((spine*sin(th1 - th2 + th3))/2 + crus*sin(th1) + thigh*sin(th1 - th2)) + m4*(spine*cos(th1 - th2 + th3) + crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1ddot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - crus*th1dot^2*sin(th1) + thigh*cos(th1 - th2)*(th1ddot - th2ddot) - spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 - thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - g*m5*(spine*sin(th1 - th2 + th3) - bicep_arm*sin(th1 - th2 + th3 - th4) + crus*sin(th1) + thigh*sin(th1 - th2) - (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) - g*m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + crus*sin(th1) + thigh*sin(th1 - th2)) + m3*((spine*sin(th1 - th2 + th3))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1ddot*sin(th1) + crus*th1dot^2*cos(th1) + (spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot))/2 + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + crus^2*m2*th1ddot*cos(th1)^2 + (crus^2*m1*th1ddot*sin(th1)^2)/4 - (crus*g*m1*sin(th1))/2 + (crus^2*m1*th1dot^2*cos(th1)*sin(th1))/4 - crus^2*m2*th1dot^2*cos(th1)*sin(th1);
 
tau2 = g*m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + thigh*sin(th1 - th2)) - g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) - thigh*sin(th1 - th2) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) - m4*(spine*cos(th1 - th2 + th3) + thigh*cos(th1 - th2))*(crus*th1ddot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - crus*th1dot^2*sin(th1) + thigh*cos(th1 - th2)*(th1ddot - th2ddot) - spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 - thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - m3*((spine*sin(th1 - th2 + th3))/2 + thigh*sin(th1 - th2))*(crus*th1ddot*sin(th1) + crus*th1dot^2*cos(th1) + (spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot))/2 + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + m5*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + thigh*cos(th1 - th2))*(bicep_arm*cos(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) - crus*th1ddot*cos(th1) - spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*sin(th1) - thigh*cos(th1 - th2)*(th1ddot - th2ddot) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + thigh*sin(th1 - th2))*(crus*th1ddot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot))/2 - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) - thigh*sin(th1 - th2) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1ddot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2ddot - th1ddot - th3ddot + th4ddot + th5ddot))/2 - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + g*m3*((spine*sin(th1 - th2 + th3))/2 + thigh*sin(th1 - th2)) - m3*thigh*cos(th1 - th2)*(crus*th1ddot*cos(th1) - crus*th1dot^2*sin(th1) + thigh*cos(th1 - th2)*(th1ddot - th2ddot) - thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + (g*m2*thigh*sin(th1 - th2))/2 - (m2*thigh*sin(th1 - th2)*(crus*th1ddot*sin(th1) + crus*th1dot^2*cos(th1) + (thigh*sin(th1 - th2)*(th1ddot - th2ddot))/2 + (thigh*cos(th1 - th2)*(th1dot - th2dot)^2)/2))/2;
 
tau3 = g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) + g*m4*((bicep_arm*sin(th1 - th2 + th3 - th4))/2 - spine*sin(th1 - th2 + th3)) + m5*(bicep_arm*cos(th1 - th2 + th3 - th4) - spine*cos(th1 - th2 + th3))*(bicep_arm*cos(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) - crus*th1ddot*cos(th1) - spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*sin(th1) - thigh*cos(th1 - th2)*(th1ddot - th2ddot) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - m4*((bicep_arm*sin(th1 - th2 + th3 - th4))/2 - spine*sin(th1 - th2 + th3))*(crus*th1ddot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot))/2 - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1ddot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2ddot - th1ddot - th3ddot + th4ddot + th5ddot))/2 - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - (g*m3*spine*sin(th1 - th2 + th3))/2 + m4*spine*cos(th1 - th2 + th3)*(crus*th1ddot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - crus*th1dot^2*sin(th1) + thigh*cos(th1 - th2)*(th1ddot - th2ddot) - spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 - thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + (m3*spine*sin(th1 - th2 + th3)*(crus*th1ddot*sin(th1) + crus*th1dot^2*cos(th1) + (spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot))/2 + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2;

tau4 = m5*(bicep_arm*sin(th1 - th2 + th3 - th4) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1ddot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2ddot - th1ddot - th3ddot + th4ddot + th5ddot))/2 - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) - bicep_arm*m5*cos(th1 - th2 + th3 - th4)*(bicep_arm*cos(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) - crus*th1ddot*cos(th1) - spine*cos(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*sin(th1) - thigh*cos(th1 - th2)*(th1ddot - th2ddot) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + (bicep_arm*m4*sin(th1 - th2 + th3 - th4)*(crus*th1ddot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot))/2 - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2 - (bicep_arm*g*m4*sin(th1 - th2 + th3 - th4))/2;

tau5 = (forearm*m5*sin(th1 - th2 + th3 - th4 - th5)*(crus*th1ddot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1ddot - th2ddot + th3ddot - th4ddot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2ddot - th1ddot - th3ddot + th4ddot + th5ddot))/2 - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + crus*th1dot^2*cos(th1) + spine*sin(th1 - th2 + th3)*(th1ddot - th2ddot + th3ddot) + thigh*sin(th1 - th2)*(th1ddot - th2ddot) - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2 - (forearm*g*m5*sin(th1 - th2 + th3 - th4 - th5))/2;

% Coriolis vector components:  obtained by assigning all thddot and g components to 0.

C1= m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1dot^2*cos(th1) - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - m5*(crus*th1dot^2*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2)*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + crus*cos(th1) + thigh*cos(th1 - th2)) - m3*(crus*th1dot^2*sin(th1) + thigh*sin(th1 - th2)*(th1dot - th2dot)^2)*(crus*cos(th1) + thigh*cos(th1 - th2)) + m2*(crus*th1dot^2*cos(th1) + (thigh*cos(th1 - th2)*(th1dot - th2dot)^2)/2)*(crus*sin(th1) + (thigh*sin(th1 - th2))/2) - m4*(spine*cos(th1 - th2 + th3) + crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1dot^2*sin(th1) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + m3*((spine*sin(th1 - th2 + th3))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1dot^2*cos(th1) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + m5*(spine*sin(th1 - th2 + th3) - bicep_arm*sin(th1 - th2 + th3 - th4) + crus*sin(th1) + thigh*sin(th1 - th2) - (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot^2*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + (crus^2*m1*th1dot^2*cos(th1)*sin(th1))/4 - crus^2*m2*th1dot^2*cos(th1)*sin(th1);
C2= m4*(spine*cos(th1 - th2 + th3) + thigh*cos(th1 - th2))*(crus*th1dot^2*sin(th1) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) + m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) - thigh*sin(th1 - th2) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot^2*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + thigh*sin(th1 - th2))*(crus*th1dot^2*cos(th1) - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + m5*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + thigh*cos(th1 - th2))*(crus*th1dot^2*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - m3*((spine*sin(th1 - th2 + th3))/2 + thigh*sin(th1 - th2))*(crus*th1dot^2*cos(th1) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - (m2*thigh*sin(th1 - th2)*(crus*th1dot^2*cos(th1) + (thigh*cos(th1 - th2)*(th1dot - th2dot)^2)/2))/2 + m3*thigh*cos(th1 - th2)*(crus*th1dot^2*sin(th1) + thigh*sin(th1 - th2)*(th1dot - th2dot)^2);
C3=m5*(bicep_arm*cos(th1 - th2 + th3 - th4) - spine*cos(th1 - th2 + th3))*(crus*th1dot^2*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2) - m4*((bicep_arm*sin(th1 - th2 + th3 - th4))/2 - spine*sin(th1 - th2 + th3))*(crus*th1dot^2*cos(th1) - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) - m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot^2*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + (m3*spine*sin(th1 - th2 + th3)*(crus*th1dot^2*cos(th1) + (spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2)/2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2 - m4*spine*cos(th1 - th2 + th3)*(crus*th1dot^2*sin(th1) + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2);
C4=m5*(bicep_arm*sin(th1 - th2 + th3 - th4) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot^2*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2) + (bicep_arm*m4*sin(th1 - th2 + th3 - th4)*(crus*th1dot^2*cos(th1) - (bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2 - bicep_arm*m5*cos(th1 - th2 + th3 - th4)*(crus*th1dot^2*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*sin(th1 - th2)*(th1dot - th2dot)^2);
C5=(forearm*m5*sin(th1 - th2 + th3 - th4 - th5)*(crus*th1dot^2*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot)^2 - (forearm*cos(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot)^2)/2 + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot)^2 + thigh*cos(th1 - th2)*(th1dot - th2dot)^2))/2;

% Inertia matrix components by assigning g=0, subtracting Coriolis and
% finding coeficients of all thddots

m11=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (crus^2*m1)/8 + crus^2*m2 + crus^2*m3 + crus^2*m4 + crus^2*m5 + (forearm^2*m5)/8 + (m3*spine^2)/8 + m4*spine^2 + m5*spine^2 + (m2*thigh^2)/8 + m3*thigh^2 + m4*thigh^2 + m5*thigh^2 - (m2*thigh^2*cos(2*th1 - 2*th2))/8 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 - (crus^2*m1*cos(2*th1))/8 - (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (crus*m2*thigh*cos(2*th1 - th2))/2 - (bicep_arm*crus*m4*cos(th2 - th3 + th4))/2 - 2*bicep_arm*crus*m5*cos(th2 - th3 + th4) + (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/2 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/2 + (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/2 - (forearm*m5*spine*cos(th4 + th5))/2 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/2 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/2 - 2*bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (crus*m2*thigh*cos(th2))/2 + 2*crus*m3*thigh*cos(th2) + 2*crus*m4*thigh*cos(th2) + 2*crus*m5*thigh*cos(th2) - (crus*m3*spine*cos(2*th1 - th2 + th3))/2 - (forearm*m5*thigh*cos(th3 - th4 - th5))/2 - (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/2 + (m3*spine*thigh*cos(th3))/2 + 2*m4*spine*thigh*cos(th3) + 2*m5*spine*thigh*cos(th3) + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 - (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/2 - (bicep_arm*m4*thigh*cos(th3 - th4))/2 - 2*bicep_arm*m5*thigh*cos(th3 - th4) + (crus*m3*spine*cos(th2 - th3))/2 + 2*crus*m4*spine*cos(th2 - th3) + 2*crus*m5*spine*cos(th2 - th3) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m12=(m2*thigh^2*cos(2*th1 - 2*th2))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (m3*spine^2)/8 - m4*spine^2 - m5*spine^2 - (m2*thigh^2)/8 - m3*thigh^2 - m4*thigh^2 - m5*thigh^2 - (bicep_arm^2*m4)/8 + (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 + (crus*m2*thigh*cos(2*th1 - th2))/4 + (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 + bicep_arm*crus*m5*cos(th2 - th3 + th4) - (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/2 - (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 + (forearm*m5*spine*cos(th4 + th5))/2 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/2 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/2 + 2*bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (crus*m2*thigh*cos(th2))/4 - crus*m3*thigh*cos(th2) - crus*m4*thigh*cos(th2) - crus*m5*thigh*cos(th2) + (crus*m3*spine*cos(2*th1 - th2 + th3))/4 + (forearm*m5*thigh*cos(th3 - th4 - th5))/2 + (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 - (m3*spine*thigh*cos(th3))/2 - 2*m4*spine*thigh*cos(th3) - 2*m5*spine*thigh*cos(th3) - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 + (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/2 + (bicep_arm*m4*thigh*cos(th3 - th4))/2 + 2*bicep_arm*m5*thigh*cos(th3 - th4) - (crus*m3*spine*cos(th2 - th3))/4 - crus*m4*spine*cos(th2 - th3) - crus*m5*spine*cos(th2 - th3) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m13=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 + (m3*spine^2)/8 + m4*spine^2 + m5*spine^2 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 - (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 - bicep_arm*crus*m5*cos(th2 - th3 + th4) + (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 + (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 - (forearm*m5*spine*cos(th4 + th5))/2 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/2 - 2*bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (crus*m3*spine*cos(2*th1 - th2 + th3))/4 - (forearm*m5*thigh*cos(th3 - th4 - th5))/4 - (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 + (m3*spine*thigh*cos(th3))/4 + m4*spine*thigh*cos(th3) + m5*spine*thigh*cos(th3) + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 - (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/4 - (bicep_arm*m4*thigh*cos(th3 - th4))/4 - bicep_arm*m5*thigh*cos(th3 - th4) + (crus*m3*spine*cos(th2 - th3))/4 + crus*m4*spine*cos(th2 - th3) + crus*m5*spine*cos(th2 - th3) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m14=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 + bicep_arm*crus*m5*cos(th2 - th3 + th4) - (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 - (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 + (forearm*m5*spine*cos(th4 + th5))/4 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/4 + bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (forearm*m5*thigh*cos(th3 - th4 - th5))/4 + (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 + (bicep_arm*m4*thigh*cos(th3 - th4))/4 + bicep_arm*m5*thigh*cos(th3 - th4) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m15=-(forearm*m5*(forearm + 2*crus*cos(2*th1 - th2 + th3 - th4 - th5) + 2*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5) - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) - 2*thigh*cos(th3 - th4 - th5) - 2*crus*cos(th2 - th3 + th4 + th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;


m21=(m2*thigh^2*cos(2*th1 - 2*th2))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (m3*spine^2)/8 - m4*spine^2 - m5*spine^2 - (m2*thigh^2)/8 - m3*thigh^2 - m4*thigh^2 - m5*thigh^2 - (bicep_arm^2*m4)/8 + (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 + (crus*m2*thigh*cos(2*th1 - th2))/4 + (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 + bicep_arm*crus*m5*cos(th2 - th3 + th4) - (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/2 - (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 + (forearm*m5*spine*cos(th4 + th5))/2 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/2 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/2 + 2*bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (crus*m2*thigh*cos(th2))/4 - crus*m3*thigh*cos(th2) - crus*m4*thigh*cos(th2) - crus*m5*thigh*cos(th2) + (crus*m3*spine*cos(2*th1 - th2 + th3))/4 + (forearm*m5*thigh*cos(th3 - th4 - th5))/2 + (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 - (m3*spine*thigh*cos(th3))/2 - 2*m4*spine*thigh*cos(th3) - 2*m5*spine*thigh*cos(th3) - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 + (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/2 + (bicep_arm*m4*thigh*cos(th3 - th4))/2 + 2*bicep_arm*m5*thigh*cos(th3 - th4) - (crus*m3*spine*cos(th2 - th3))/4 - crus*m4*spine*cos(th2 - th3) - crus*m5*spine*cos(th2 - th3) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m22=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 + (m3*spine^2)/8 + m4*spine^2 + m5*spine^2 + (m2*thigh^2)/8 + m3*thigh^2 + m4*thigh^2 + m5*thigh^2 - (m2*thigh^2*cos(2*th1 - 2*th2))/8 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 - (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/2 - (forearm*m5*spine*cos(th4 + th5))/2 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/2 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/2 - 2*bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (forearm*m5*thigh*cos(th3 - th4 - th5))/2 + (m3*spine*thigh*cos(th3))/2 + 2*m4*spine*thigh*cos(th3) + 2*m5*spine*thigh*cos(th3) + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 - (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/2 - (bicep_arm*m4*thigh*cos(th3 - th4))/2 - 2*bicep_arm*m5*thigh*cos(th3 - th4) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m23=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (m3*spine^2)/8 - m4*spine^2 - m5*spine^2 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 + (forearm*m5*spine*cos(th4 + th5))/2 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/2 + 2*bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (forearm*m5*thigh*cos(th3 - th4 - th5))/4 - (m3*spine*thigh*cos(th3))/4 - m4*spine*thigh*cos(th3) - m5*spine*thigh*cos(th3) - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 + (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/4 + (bicep_arm*m4*thigh*cos(th3 - th4))/4 + bicep_arm*m5*thigh*cos(th3 - th4) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m24=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 - (forearm*m5*spine*cos(th4 + th5))/4 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/4 - bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (forearm*m5*thigh*cos(th3 - th4 - th5))/4 + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 - (bicep_arm*m4*thigh*cos(th3 - th4))/4 - bicep_arm*m5*thigh*cos(th3 - th4) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m25=(forearm*m5*(forearm + 2*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5) - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) - 2*thigh*cos(th3 - th4 - th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;


m31=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 + (m3*spine^2)/8 + m4*spine^2 + m5*spine^2 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 - (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 - bicep_arm*crus*m5*cos(th2 - th3 + th4) + (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 + (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 - (forearm*m5*spine*cos(th4 + th5))/2 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/2 - 2*bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (crus*m3*spine*cos(2*th1 - th2 + th3))/4 - (forearm*m5*thigh*cos(th3 - th4 - th5))/4 - (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 + (m3*spine*thigh*cos(th3))/4 + m4*spine*thigh*cos(th3) + m5*spine*thigh*cos(th3) + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 - (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/4 - (bicep_arm*m4*thigh*cos(th3 - th4))/4 - bicep_arm*m5*thigh*cos(th3 - th4) + (crus*m3*spine*cos(th2 - th3))/4 + crus*m4*spine*cos(th2 - th3) + crus*m5*spine*cos(th2 - th3) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m32=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (m3*spine^2)/8 - m4*spine^2 - m5*spine^2 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 + (forearm*m5*spine*cos(th4 + th5))/2 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/2 + 2*bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (forearm*m5*thigh*cos(th3 - th4 - th5))/4 - (m3*spine*thigh*cos(th3))/4 - m4*spine*thigh*cos(th3) - m5*spine*thigh*cos(th3) - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 + (m3*spine*thigh*cos(2*th1 - 2*th2 + th3))/4 + (bicep_arm*m4*thigh*cos(th3 - th4))/4 + bicep_arm*m5*thigh*cos(th3 - th4) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m33=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 + (m3*spine^2)/8 + m4*spine^2 + m5*spine^2 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 - (m3*spine^2*cos(2*th1 - 2*th2 + 2*th3))/8 - (forearm*m5*spine*cos(th4 + th5))/2 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/2 - 2*bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/2 + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/2;
m34=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (forearm*m5*spine*cos(th4 + th5))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/4 + bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m35=-(forearm*m5*(forearm - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;


m41=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (bicep_arm*crus*m4*cos(th2 - th3 + th4))/4 + bicep_arm*crus*m5*cos(th2 - th3 + th4) - (crus*forearm*m5*cos(2*th1 - th2 + th3 - th4 - th5))/4 - (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 - (bicep_arm*crus*m4*cos(2*th1 - th2 + th3 - th4))/4 + (forearm*m5*spine*cos(th4 + th5))/4 - (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/4 + bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 + (forearm*m5*thigh*cos(th3 - th4 - th5))/4 + (crus*forearm*m5*cos(th2 - th3 + th4 + th5))/4 - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 + (bicep_arm*m4*thigh*cos(th3 - th4))/4 + bicep_arm*m5*thigh*cos(th3 - th4) - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m42=(bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (forearm*m5*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5))/4 - (forearm*m5*spine*cos(th4 + th5))/4 + (bicep_arm*m4*thigh*cos(2*th1 - 2*th2 + th3 - th4))/4 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*m4*spine*cos(th4))/4 - bicep_arm*m5*spine*cos(th4) - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (forearm*m5*thigh*cos(th3 - th4 - th5))/4 + (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 - (bicep_arm*m4*thigh*cos(th3 - th4))/4 - bicep_arm*m5*thigh*cos(th3 - th4) + (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m43=(forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - bicep_arm^2*m5 - (forearm^2*m5)/8 - (bicep_arm^2*m4)/8 + (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (forearm*m5*spine*cos(th4 + th5))/4 - (bicep_arm*forearm*m5*cos(th5))/2 + (bicep_arm*m4*spine*cos(th4))/4 + bicep_arm*m5*spine*cos(th4) + (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2 - (forearm*m5*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5))/4 - (bicep_arm*m4*spine*cos(2*th1 - 2*th2 + 2*th3 - th4))/4;
m44= (bicep_arm^2*m4)/8 + bicep_arm^2*m5 + (forearm^2*m5)/8 - (forearm^2*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5))/8 - (bicep_arm^2*m4*cos(2*th1 - 2*th2 + 2*th3 - 2*th4))/8 + (bicep_arm*forearm*m5*cos(th5))/2 - (bicep_arm*forearm*m5*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5))/2;
m45= (forearm*m5*(forearm + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5)))/8;
 
 
m51= -(forearm*m5*(forearm + 2*crus*cos(2*th1 - th2 + th3 - th4 - th5) + 2*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5) - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) - 2*thigh*cos(th3 - th4 - th5) - 2*crus*cos(th2 - th3 + th4 + th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;
m52= (forearm*m5*(forearm + 2*thigh*cos(2*th1 - 2*th2 + th3 - th4 - th5) - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) - 2*thigh*cos(th3 - th4 - th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;
m53=-(forearm*m5*(forearm - 2*spine*cos(th4 + th5) + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) + 2*spine*cos(2*th1 - 2*th2 + 2*th3 - th4 - th5)))/8;
m54= (forearm*m5*(forearm + 2*bicep_arm*cos(th5) - 2*bicep_arm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - th5) - forearm*cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5)))/8;
m55= -(forearm^2*m5*(cos(2*th1 - 2*th2 + 2*th3 - 2*th4 - 2*th5) - 1))/8; 

% Gravity vector
G1=- g*m2*(crus*sin(th1) + (thigh*sin(th1 - th2))/2) - g*m3*((spine*sin(th1 - th2 + th3))/2 + crus*sin(th1) + thigh*sin(th1 - th2)) - g*m5*(spine*sin(th1 - th2 + th3) - bicep_arm*sin(th1 - th2 + th3 - th4) + crus*sin(th1) + thigh*sin(th1 - th2) - (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) - g*m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + crus*sin(th1) + thigh*sin(th1 - th2)) - (crus*g*m1*sin(th1))/2;
G2= g*m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + thigh*sin(th1 - th2)) - g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) - thigh*sin(th1 - th2) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) + g*m3*((spine*sin(th1 - th2 + th3))/2 + thigh*sin(th1 - th2)) + (g*m2*thigh*sin(th1 - th2))/2;
G3= g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) + g*m4*((bicep_arm*sin(th1 - th2 + th3 - th4))/2 - spine*sin(th1 - th2 + th3)) - (g*m3*spine*sin(th1 - th2 + th3))/2;
G4=- g*m5*(bicep_arm*sin(th1 - th2 + th3 - th4) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) - (bicep_arm*g*m4*sin(th1 - th2 + th3 - th4))/2;
G5=-(forearm*g*m5*sin(th1 - th2 + th3 - th4 - th5))/2;


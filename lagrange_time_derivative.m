clear all;clc;

syms t;
syms  th1(t) th2(t) th3(t) th4(t) th5(t) th1dot(t) th2dot(t) th3dot(t) th4dot(t) th5dot(t);
syms m1 m2 m3 m4 m5 ;
syms waist_width crus thigh spine shoulder bicep_arm forearm; % length of parts


Q1 = m5*(crus*th1dot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot))*(spine*sin(th1 - th2 + th3) - bicep_arm*sin(th1 - th2 + th3 - th4) + crus*sin(th1) + thigh*sin(th1 - th2) - (forearm*sin(th1 - th2 + th3 - th4 - th5))/2) + m4*(spine*cos(th1 - th2 + th3) + crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1dot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) + m5*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1dot*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) + m3*(crus*cos(th1) + thigh*cos(th1 - th2))*(crus*th1dot*cos(th1) + thigh*cos(th1 - th2)*(th1dot - th2dot)) + m3*((spine*sin(th1 - th2 + th3))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1dot*sin(th1) + (spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot))/2 + thigh*sin(th1 - th2)*(th1dot - th2dot)) + m2*(crus*th1dot*sin(th1) + (thigh*sin(th1 - th2)*(th1dot - th2dot))/2)*(crus*sin(th1) + (thigh*sin(th1 - th2))/2) + m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + crus*sin(th1) + thigh*sin(th1 - th2))*(crus*th1dot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) + crus^2*m2*th1dot*cos(th1)^2 + (crus^2*m1*th1dot*sin(th1)^2)/4;
Q2 = m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) - thigh*sin(th1 - th2) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) - m4*(spine*sin(th1 - th2 + th3) - (bicep_arm*sin(th1 - th2 + th3 - th4))/2 + thigh*sin(th1 - th2))*(crus*th1dot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) - m3*((spine*sin(th1 - th2 + th3))/2 + thigh*sin(th1 - th2))*(crus*th1dot*sin(th1) + (spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot))/2 + thigh*sin(th1 - th2)*(th1dot - th2dot)) - m4*(spine*cos(th1 - th2 + th3) + thigh*cos(th1 - th2))*(crus*th1dot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) - m5*(spine*cos(th1 - th2 + th3) - bicep_arm*cos(th1 - th2 + th3 - th4) + thigh*cos(th1 - th2))*(crus*th1dot*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) - m3*thigh*cos(th1 - th2)*(crus*th1dot*cos(th1) + thigh*cos(th1 - th2)*(th1dot - th2dot)) - (m2*thigh*sin(th1 - th2)*(crus*th1dot*sin(th1) + (thigh*sin(th1 - th2)*(th1dot - th2dot))/2))/2;
Q3 = m4*spine*cos(th1 - th2 + th3)*(crus*th1dot*cos(th1) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) - m5*(bicep_arm*sin(th1 - th2 + th3 - th4) - spine*sin(th1 - th2 + th3) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) - m5*(bicep_arm*cos(th1 - th2 + th3 - th4) - spine*cos(th1 - th2 + th3))*(crus*th1dot*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot)) - m4*((bicep_arm*sin(th1 - th2 + th3 - th4))/2 - spine*sin(th1 - th2 + th3))*(crus*th1dot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) + (m3*spine*sin(th1 - th2 + th3)*(crus*th1dot*sin(th1) + (spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot))/2 + thigh*sin(th1 - th2)*(th1dot - th2dot)))/2;
Q4 =m5*(bicep_arm*sin(th1 - th2 + th3 - th4) + (forearm*sin(th1 - th2 + th3 - th4 - th5))/2)*(crus*th1dot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)) + (bicep_arm*m4*sin(th1 - th2 + th3 - th4)*(crus*th1dot*sin(th1) - (bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)))/2 + bicep_arm*m5*cos(th1 - th2 + th3 - th4)*(crus*th1dot*cos(th1) - bicep_arm*cos(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + spine*cos(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*cos(th1 - th2)*(th1dot - th2dot));
Q5 =(forearm*m5*sin(th1 - th2 + th3 - th4 - th5)*(crus*th1dot*sin(th1) - bicep_arm*sin(th1 - th2 + th3 - th4)*(th1dot - th2dot + th3dot - th4dot) + (forearm*sin(th1 - th2 + th3 - th4 - th5)*(th2dot - th1dot - th3dot + th4dot + th5dot))/2 + spine*sin(th1 - th2 + th3)*(th1dot - th2dot + th3dot) + thigh*sin(th1 - th2)*(th1dot - th2dot)))/2;
  
R1=diff(Q1,t);
R2=diff(Q2,t);
R3=diff(Q3,t);
R4=diff(Q4,t);
R5=diff(Q5,t);